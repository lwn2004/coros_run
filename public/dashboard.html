<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>æˆ‘çš„è·‘æ­¥ä»ªè¡¨ç›˜ ğŸƒâ€â™‚ï¸</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.24.2/bootstrap-table.min.css">
    <style>
        body { background-color: #f4f7f6; }
        .stat-card {
            border: none; border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            width: 100%; /* ç¡®ä¿å¡ç‰‡å……æ»¡è½®æ’­é¡¹ */
        }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.12); }
        .stat-card .card-body { display: flex; align-items: center; }
        .stat-card .icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            margin-right: 20px;
        }     
        h1, h2, h3 { font-weight: 600; }
        .carousel-container {
            position: relative;
        }
        .chart-container { height: 300px; }
        @media (min-width: 768px) {
            #statsCarousel .carousel-inner, #chartsCarousel .carousel-inner {
                display: flex;
            }
            #statsCarousel .carousel-item, #chartsCarousel .carousel-item {
                display: block;
                margin-right: 1.5rem; /* g-4 in bootstrap */
            }
            #statsCarousel .carousel-item:last-child, #chartsCarousel .carousel-item:last-child {
                margin-right: 0;
            }
            .carousel-control-prev, .carousel-control-next, .carousel-indicators {
                display: none !important;
            }
        }
        @media (max-width: 767.98px) {
            #statsCarousel, #chartsCarousel {
                margin-left: -0.75rem; /* æŠµæ¶ˆ container-fluid çš„ p-3 */
                margin-right: -0.75rem;
            }
            .carousel-item {
                padding: 0 0.5rem; /* ç»™å¡ç‰‡ä¹‹é—´ç•™å‡ºä¸€ç‚¹ç©ºéš™ */
            }
            .carousel-indicators [data-bs-target] {
                background-color: #0d6efd;
            }
        #filter-buttons .btn {
            margin-bottom: 0.5rem; /* åœ¨ç§»åŠ¨ç«¯æ¢è¡Œæ—¶æä¾›é—´è· */
        }
    </style>
</head>
<body>
    <div class="container-fluid p-3 p-md-4">
        <div class="d-flex align-items-center mb-4">
            <h1 class="mb-0">è·‘æ­¥ä»ªè¡¨ç›˜</h1>
            <i class="bi bi-person-running h1 ms-3 text-primary"></i>
        </div>
        <div id="statsCarousel" class="carousel slide d-md-flex mb-4" data-bs-ride="false">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#statsCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#statsCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#statsCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                <button type="button" data-bs-target="#statsCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>              
            </div>          
            <div class="carousel-inner" id="summary-stats-container">
            </div>
        </div>
        <div id="chartsCarousel" class="carousel slide d-md-block mb-4" data-bs-ride="false">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#chartsCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#chartsCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            </div>
            <div class="carousel-inner" id="charts-container">
                <div class="carousel-item active">
                    <div class="card stat-card">
                        <div class="card-body chart-container" style="display:block;">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                     <div class="card stat-card">
                        <div class="card-body chart-container" style="display:block;">
                            <canvas id="paceTrendChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card stat-card">
             <div class="card-body" style="display: block;">
                <h3 class="card-title mb-3">è¯¦ç»†è®°å½•</h3>
                <div id="filter-buttons" class="btn-toolbar mb-3" role="toolbar">
                    <div class="btn-group flex-wrap" role="group">
                        <button type="button" class="btn btn-primary active" data-filter="all">
                            <i class="bi bi-list-ul me-1"></i> å…¨éƒ¨è®°å½•
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-filter="race">
                            <i class="bi bi-trophy me-1"></i> æ¯”èµ›
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-filter="hm">
                            <i class="bi bi-signpost-split me-1"></i> â‰¥ åŠé©¬
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-filter="pb">
                            <i class="bi bi-award me-1"></i> ä¸ªäººæœ€ä½³
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-filter="this-month">
                            <i class="bi bi-calendar-month me-1"></i> æœ¬æœˆ
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-filter="on-this-day">
                            <i class="bi bi-clock-history me-1"></i> å†å²ä¸Šçš„ä»Šå¤©
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="runTable"></table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="runDetailModal" tabindex="-1" aria-labelledby="runDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="runDetailModalLabel">è·‘æ­¥è¯¦æƒ…</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modalBodyContent">
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.24.2/bootstrap-table.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/locale/zh-cn.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <script>
        moment.locale('zh-cn');
        function timeToSeconds(timeStr) {
          // Split the main H:M:S part from the (unused) microseconds
          const parts = timeStr.split('.');
          const [hours, minutes, seconds] = parts[0].split(':').map(Number);
          
          // Handle fractional seconds from the original string if needed
          const fractionalSeconds = parts[1] ? parseFloat(`0.${parts[1]}`) : 0;
        
          return (hours * 3600) + (minutes * 60) + seconds + fractionalSeconds;
        }      
        function paceFormatter(value) {// from "m/s" to pace `x'y"`
            if (!value || value <= 0) return '-';
            const paceSeconds = 1000 / value;
            const minutes = Math.floor(paceSeconds / 60);
            const seconds = String(Math.round(paceSeconds % 60)).padStart(2, '0');
            return `${minutes}'${seconds}"`;
        }
        function durationFormatter(value) {
            if (!value) return '-';
            const duration = moment.duration(value, 'seconds');
            const hours = Math.floor(duration.asHours());
            const minutes = duration.minutes();
            const seconds = duration.seconds();
            return `${hours > 0 ? hours + ':' : ''}${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        function dateFormatter(value) {
            if (!value) return '-';
            return moment(value).format('YYYY-MM-DD');
        }
        function distanceFormatter(value) {
            if (!value || value <= 0) return '-';
            return (value / 1000).toFixed(2);
        }
        function elevationFormatter(value) {
            if (!value || value < 0) return '-';
            return `<i class="bi bi-mountain me-1 text-success"></i>${Math.round(value)}m`;
        }
        function typeFormatter(value) {
            const icons = {
                'Race': '<i class="bi bi-trophy-fill text-warning me-2"></i>æ¯”èµ›',
                'Long Run': '<i class="bi bi-sign-turn-right-fill text-info me-2"></i>é•¿è·ç¦»',
                'Easy Run': '<i class="bi bi-wind text-success me-2"></i>è½»æ¾è·‘',
                'Interval': '<i class="bi bi-hourglass-split text-danger me-2"></i>é—´æ­‡è·‘',
                'Workout': '<i class="bi bi-lightning-fill text-primary me-2"></i>è®­ç»ƒ',
                'default': '<i class="bi bi-activity me-2"></i>è·‘æ­¥'
            };
            return icons[value] || icons['default'];
        }
        function nameFormatter(value, row) {
            let pbBadge = '';
            if (row.is_pb_5k || row.is_pb_10k || row.is_pb_hm || row.is_pb_m) {
                pbBadge = '<span class="pb-badge ms-2" title="ä¸ªäººæœ€ä½³çºªå½•!">ğŸ…</span>';
            }
            return `<strong>${value || 'æœªå‘½åè·‘æ­¥'}</strong>${pbBadge}`;
        }
        // æ–°å¢/ä¿®æ”¹: åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡æ¥å­˜å‚¨æ‰€æœ‰è·‘æ­¥æ•°æ®
        let allRunsData = [];
        $(document).ready(function() {
            fetch('data/all.json')
                .then(response => response.json())
                .then(data => {
                    // å°†è·å–çš„æ•°æ®å­˜å‚¨åˆ°å…¨å±€å˜é‡ä¸­
                    allRunsData = data;
                    // é¡µé¢åŠ è½½æ—¶ï¼Œä½¿ç”¨å®Œæ•´æ•°æ®åˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶
                    updateSummaryCarousel(allRunsData);
                    renderAllCharts(allRunsData);
                    initializeRunTable(allRunsData);
                })
                .catch(error => {
                    console.error('åŠ è½½è·‘æ­¥æ•°æ®å¤±è´¥:', error);
                    $('#summary-stats').html('<div class="col"><p class="text-danger">æ— æ³•åŠ è½½æ•°æ®ï¼Œè¯·æ£€æŸ¥all.jsonæ–‡ä»¶æ˜¯å¦å­˜åœ¨æˆ–æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚</p></div>');
                });
            $('#filter-buttons').on('click', '.btn', function() {
                // è®¾ç½®æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
                $(this).addClass('active').siblings().removeClass('active');
                $(this).removeClass('btn-outline-primary').addClass('btn-primary')
                    .siblings().removeClass('btn-primary').addClass('btn-outline-primary');
                const filterType = $(this).data('filter');
                applyTableFilter(filterType);
            });
        });
        function updateSummaryCarousel(data) {
            if (!data || data.length === 0) return;
            const totalRuns = data.length;
            const totalDistance = data.reduce((sum, run) => sum + run.distance, 0);
            const totalDuration = data.reduce((sum, run) => sum + moment.duration(run.moving_time).asSeconds(), 0);
            const totalElevation = data.reduce((sum, run) => sum + run.total_elevation_gain, 0);
            const avgPaceSeconds = totalDuration / (totalDistance / 1000);
            const avgSpeed = totalDistance/totalDuration;//"m/s"
            const stats = [
                {
                    label: 'æ€»é‡Œç¨‹',
                    value: `${(totalDistance / 1000).toFixed(2)} km`,
                    icon: 'bi-sign-merge-right-fill',
                    color: '#0d6efd'
                },
                {
                    label: 'æ€»æ¬¡æ•°',
                    value: `${totalRuns} æ¬¡`,
                    icon: 'bi-calendar-check-fill',
                    color: '#198754'
                },
                {
                    label: 'æ€»æ—¶é•¿',
                    value: durationFormatter(totalDuration),
                    icon: 'bi-hourglass-top',
                    color: '#ffc107'
                },
                {
                    label: 'å¹³å‡é…é€Ÿ',
                    value: `${paceFormatter(avgSpeed)} /km`,
                    icon: 'bi-speedometer2',
                    color: '#dc3545'
                },/*
                {
                    label: 'æ€»çˆ¬å‡',
                    value: `${Math.round(totalElevation)} ç±³`,
                    icon: 'bi-mountain',
                    color: '#6f42c1'
                }*/
            ];
            let cardsHtml = '';
            stats.forEach((stat, index) => {
                // ç¬¬ä¸€ä¸ªiteméœ€è¦åŠ  'active' ç±»
                const activeClass = index === 0 ? 'active' : '';
                cardsHtml += `
                    <div class="carousel-item ${activeClass} col-md">
                        <div class="card stat-card">
                            <div class="card-body">
                                <div class="icon" style="background-color: ${stat.color};"><i class="bi ${stat.icon}"></i></div>
                                <div>
                                    <h6 class="card-subtitle mb-2 text-muted">${stat.label}</h6>
                                    <h3 class="card-title">${stat.value}</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            $('#summary-stats-container').html(cardsHtml);
        }
        // æ–°å¢/ä¿®æ”¹: æ¸²æŸ“æ‰€æœ‰å›¾è¡¨çš„å‡½æ•°
        function renderAllCharts(data) {
            renderMonthlyChart(data);
            renderPaceTrendChart(data); // æ–°å¢çš„å›¾è¡¨
        }
        function renderMonthlyChart(data) {
            const monthlyData = {};
            data.forEach(run => {
                const month = moment(run.start_date_local).format('YYYY-MM');
                if (!monthlyData[month]) monthlyData[month] = 0;
                monthlyData[month] += run.distance / 1000;
            });
            const sortedMonths = Object.keys(monthlyData).sort().slice(-12);
            const chartLabels = sortedMonths.map(m => moment(m).format('MMM'));
            const chartData = sortedMonths.map(m => monthlyData[m].toFixed(2));
            new Chart($('#monthlyChart'), {
                type: 'bar',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        label: 'æœˆåº¦è·‘é‡ (km)',
                        data: chartData,
                        backgroundColor: 'rgba(13, 110, 253, 0.6)'
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { title: { display: true, text: 'æœ€è¿‘12ä¸ªæœˆè·‘é‡ç»Ÿè®¡' }, legend: { display: false }, }
                }
            });
        }
        // æ–°å¢: æ¸²æŸ“é…é€Ÿè¶‹åŠ¿å›¾è¡¨
        function renderPaceTrendChart(data) {
            const monthlyDistance = {};
            const monthlyDuration = {};
            data.forEach(run => {
                const month = moment(run.start_date_local).format('YYYY-MM');
                if(!monthlyDistance[month]) { 
                    monthlyDistance[month] = 0;
                    monthlyDuration[month] = 0;
                }
                monthlyDistance[month] += run.distance;
                monthlyDuration[month] += moment.duration(run.moving_time).asSeconds();
            });
            const sortedMonths = Object.keys(monthlyDistance).sort().slice(-12);
            const chartLabels = sortedMonths.map(m => moment(m).format('MMM'));
            const chartData = sortedMonths.map(m => {
                // è®¡ç®—æœˆå¹³å‡é…é€Ÿ
                const avgPaceInSeconds = monthlyDuration[m]/(monthlyDistance[m]/1000);
                return avgPaceInSeconds;
            });
            new Chart($('#paceTrendChart'), {
                type: 'line',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        label: 'æœˆå¹³å‡é…é€Ÿ',
                        data: chartData,
                        borderColor: 'rgba(220, 53, 69, 0.8)',
                        tension: 0.1,
                        fill: false
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'æœˆå¹³å‡é…é€Ÿè¶‹åŠ¿' },
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const paceSeconds = context.raw;
                                    const minutes = Math.floor(paceSeconds / 60);
                                    const seconds = String(Math.round(paceSeconds % 60)).padStart(2, '0');
                                    return `é…é€Ÿ: ${minutes}'${seconds}" /km`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            reverse: true,
                            ticks: {
                                callback: function(value, index, values) {
                                    // è‡ªå®šä¹‰Yè½´æ ‡ç­¾ï¼Œæ˜¾ç¤ºä¸º M'SS" æ ¼å¼
                                    const minutes = Math.floor(value / 60);
                                    const seconds = String(Math.round(value % 60)).padStart(2, '0');
                                    return `${minutes}'${seconds}"`;
                                }
                            }
                        }
                    }
                }
            });
        }
        function initializeRunTable(data) {
            $('#runTable').bootstrapTable({
                data: data,
                classes: 'table table-hover table-striped',
                search: true,
                pagination: true,
                pageSize: 10,
                pageList: [10, 25, 50, 'all'],
                sortName: 'start_date_local',
                sortOrder: 'desc',
                // æ–°å¢/ä¿®æ”¹: å¯ç”¨æ­¤é€‰é¡¹æ¥æ›´å¥½åœ°å¤„ç†ç§»åŠ¨ç«¯åˆ†é¡µæ 
                smartDisplay: true, 
                columns: [{
                    field: 'name',
                    title: 'è·‘æ­¥åç§°',
                    formatter: nameFormatter,
                    sortable: true,
                    class: 'd-none d-md-table-cell'                 
                }, {
                    field: 'start_date_local',
                    title: 'æ—¥æœŸ',
                    formatter: dateFormatter,
                    sortable: true
                }, {
                    field: 'distance',
                    title: 'è·ç¦»(km)',
                    formatter: distanceFormatter,
                    sortable: true
                }, {
                    field: 'average_speed',
                    title: 'é…é€Ÿ',
                    formatter: paceFormatter,
                    sortable: true
                }, {
                    field: 'moving_time',
                    title: 'æ—¶é•¿',
                    formatter: durationFormatter,
                    sortable: true,
                    // æ–°å¢/ä¿®æ”¹: ä½¿ç”¨Bootstrapçš„å“åº”å¼æ˜¾ç¤ºç±»
                    // d-none: é»˜è®¤éšè—
                    // d-md-table-cell: åœ¨ä¸­ç­‰å±å¹•(>=768px)åŠä»¥ä¸Šå°ºå¯¸ï¼Œä»¥è¡¨æ ¼å•å…ƒæ ¼å½¢å¼æ˜¾ç¤º
                    class: 'd-none d-md-table-cell'
                }, {
                    field: 'average_heartrate',
                    title: '<i class="bi bi-heart-pulse-fill text-danger"></i>',
                    sortable: true,
                    //class: 'd-none d-md-table-cell'
                }, {
                    field: 'total_elevation_gain',
                    title: 'çˆ¬å‡',
                    formatter: elevationFormatter,
                    sortable: true,
                    // æ–°å¢/ä¿®æ”¹: åœ¨å¤§å±å¹•(>=992px)åŠä»¥ä¸Šæ‰æ˜¾ç¤º
                    class: 'd-none d-lg-table-cell'
                }, {
                    field: 'type',
                    title: 'ç±»å‹',
                    formatter: typeFormatter,
                    sortable: true,
                    class: 'd-none d-lg-table-cell'
                }],
                onClickRow: function (row, $element) {
                    showRunDetails(row);
                }
            });
        }
        // æ˜¾ç¤ºè·‘æ­¥è¯¦æƒ…æ¨¡æ€æ¡†
        function showRunDetails(run) {
            $('#runDetailModalLabel').text(run.name || 'è·‘æ­¥è¯¦æƒ…');
            const modalBody = `
                <div class="row">
                    <div class="col-md-6">
                        <h4><i class="bi bi-calendar3"></i> ${moment(run.start_date_local).format('YYYYå¹´MæœˆDæ—¥ dddd HH:mm')}</h4>
                        <hr>
                        <p><strong><i class="bi bi-sign-merge-right-fill text-primary"></i> è·ç¦»:</strong> ${distanceFormatter(run.distance)} km</p>
                        <p><strong><i class="bi bi-hourglass-split text-warning"></i> æ—¶é•¿:</strong> ${durationFormatter(run.moving_time)}</p>
                        <p><strong><i class="bi bi-speedometer2 text-danger"></i> é…é€Ÿ:</strong> ${paceFormatter(run.average_speed)} /km</p>
                    </div>
                    <div class="col-md-6">
                        <h4><i class="bi bi-graph-up"></i> æ›´å¤šæ•°æ®</h4>
                        <hr>
                        <p><strong><i class="bi bi-heart-pulse-fill text-danger"></i> å¹³å‡å¿ƒç‡:</strong> ${run.average_heartrate || '-'} bpm</p>
                        <p><strong><i class="bi bi-mountain text-success"></i> ç´¯è®¡çˆ¬å‡:</strong> ${Math.round(run.total_elevation_gain || 0)} ç±³</p>
                        <p><strong><i class="bi bi-activity"></i> è·‘æ­¥ç±»å‹:</strong> ${typeFormatter(run.type)}</p>
                    </div>
                </div>
                <div class="mt-3 bg-light p-3 rounded">
                    <h6><i class="bi bi-map"></i> è·‘æ­¥åœ°å›¾ (å ä½)</h6>
                    <p class="text-muted small">æ­¤å¤„æœªæ¥å¯é›†æˆåœ°å›¾æœåŠ¡æ¥æ˜¾ç¤ºè·‘æ­¥è½¨è¿¹ã€‚</p>
                </div>
            `;
            $('#modalBodyContent').html(modalBody);
            $('#runDetailModal').modal('show');
        }        
        // æ–°å¢/ä¿®æ”¹: åº”ç”¨è¡¨æ ¼ç­›é€‰çš„æ ¸å¿ƒå‡½æ•°
        function applyTableFilter(filterType) {
            let filteredData = [];
            switch (filterType) {
                case 'race':
                    filteredData = allRunsData.filter(run => run.type === 'Race');
                    break;
                case 'hm':
                    // ç­›é€‰è·ç¦»åœ¨21kmåˆ°42kmä¹‹é—´çš„è®°å½•ï¼Œä»¥åŒ…å«GPSè¯¯å·®
                    filteredData = allRunsData.filter(run => run.distance >= 21000 && run.distance < 42000);
                    break;
                case 'pb':
                    // ç­›é€‰ä»»ä½•ä¸€é¡¹PBä¸ºtrueçš„è®°å½•
                    filteredData = allRunsData.filter(run => run.is_pb_5k || run.is_pb_10k || run.is_pb_hm || run.is_pb_m);
                    break;
                case 'this-month':
                    const startOfMonth = moment().startOf('month');
                    const endOfMonth = moment().endOf('month');
                    filteredData = allRunsData.filter(run => {
                        return moment(run.start_date_local).isBetween(startOfMonth, endOfMonth);
                    });
                    break;
                case 'on-this-day':
                    const today = moment();
                    const month = today.month(); // 0-11
                    const day = today.date();
                    filteredData = allRunsData.filter(run => {
                        const runDate = moment(run.start_date_local);
                        // æ¯”è¾ƒæœˆå’Œæ—¥ï¼Œå¿½ç•¥å¹´ä»½
                        return runDate.month() === month && runDate.date() === day;
                    });
                    break;
                case 'all':
                default:
                    filteredData = allRunsData; // æ¢å¤æ˜¾ç¤ºå…¨éƒ¨æ•°æ®
                    break;
            }
            // ä½¿ç”¨ç­›é€‰åçš„æ•°æ®é‡æ–°åŠ è½½è¡¨æ ¼
            $('#runTable').bootstrapTable('load', filteredData);
        }        
    </script>
</body>
</html>
